<!DOCTYPE HTML>
<html>

<head>
    <!--UEDITER的三个文件-->
    <script type="text/javascript" src="{:C('PLUGIN_URL')}ueditor/ueditor.config.js"></script>
    <script type="text/javascript" src="{:C('PLUGIN_URL')}ueditor/ueditor.all.min.js">

    </script>
    <script type="text/javascript" src="{:C('PLUGIN_URL')}ueditor/lang/zh-cn/zh-cn.js"></script>

    <title>Tables</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Novus Admin Panel Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
SmartPhone Compatible web template, free WebDesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <script type="application/x-javascript">
        addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);
    function hideURLbar() {
        window.scrollTo(0, 1);
    }
    </script>
    <!-- Bootstrap Core CSS -->
    <link href="{:C('CSS_URL')}bootstrap.css" rel='stylesheet' type='text/css' />
    <!-- Custom CSS -->
    <link href="{:C('CSS_URL')}style.css" rel='stylesheet' type='text/css' />
    <!-- font CSS -->
    <!-- font-awesome icons -->
    <link href="{:C('CSS_URL')}font-awesome.css" rel="stylesheet">
    <!-- //font-awesome icons -->
    <!-- js-->
    <script src="{:C('JS_URL')}jquery-1.11.1.min.js"></script>
    <script src="{:C('JS_URL')}modernizr.custom.js"></script>
    <!--webfonts-->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300,300italic,400italic,700,700italic' rel='stylesheet'
        type='text/css'>
    <!--//webfonts-->
    <!--animate-->
    <link href="{:C('CSS_URL')}animate.css" rel="stylesheet" type="text/css" media="all">
    <script src="{:C('JS_URL')}wow.min.js"></script>
    <script>
        new WOW().init();
    </script>
    <!--//end-animate-->
    <!-- Metis Menu -->
    <script src="{:C('JS_URL')}metisMenu.min.js"></script>
    <script src="{:C('JS_URL')}custom.js"></script>
    <link href="{:C('CSS_URL')}custom.css" rel="stylesheet">
    <!--//Metis Menu -->
</head>

<body class="cbp-spmenu-push">
    <div class="main-content">
        <!--left-fixed -navigation-->
        <include file="./Application/Admin/View/View/navi.html" />
        <!--left-fixed -navigation-->
        <!-- header-starts -->
        <include file="./Application/Admin/View/View/header.html" />
        <!-- //header-ends -->
        <!-- main content start-->
        <div id="page-wrapper">
            <div class="main-page">
                <div class="tables">
                    <h3 class="title1">修改商品属性</h3>
                    <div class="panel-body widget-shadow">
                        <form class="form-horizontal" action="" method="post" enctype="multipart/form-data">
                
                            <table class="table">
                                <input type="hidden" name="goods_id" value="{$gt['goods_id']}">
                                <thead>
                                    <tr>
                                        <th>键</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody id="flag">
                                    <tr>
                                        <th scope="row">商品名</th>
                                        <td><input type="text" required class="form-control1" id="focusedinput" name="goods_name" value="{$gt.goods_name}">                                            </td>

                                    </tr>
                                    <tr>
                                        <th scope="row">商品价格￥</th>
                                        <td><input type="number" required class="form-control1" id="inputPassword1" name="goods_price" value="{$gt.goods_price}">                                            </td>

                                    </tr>
                                    <tr>
                                        <th scope="row">商品重量KG</th>
                                        <td><input type="number" required class="form-control1" id="inputPassword2" name="goods_weight" value="{$gt.goods_weight}"></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">商品数量</th>
                                        <td><input type="number" required class="form-control1" id="inputPassword2" name="goods_number" value="{$gt.goods_number}"></td>
                                    </tr>

                                    <tr>
                                        <th scope="row">更新Logo</th>
                                        <td><input type="file" id="exampleInputFile" name="logo"></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">更新图册</th>
                                        <td><input type="file" multiple data-preview-file-type="any" id="exampleInputFile" name="pics[]"></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">添加商品介绍</th>
                                        <td><textarea name="goods_introduce" id="goods_introduce" cols="50" rows=10 style="height: 120px;max-width: 600px"></textarea></td>
                                    </tr>

                                    <tr>
                                        <th scope="row">所属类型</th>
                                        <td>
                                            <select name="type_id" id="type_sel" class="form-control1">
                                                <option value="">下拉选择所属类型</option>
                                                <foreach name="type_info" item="v">
                                                        <option value="{$v['type_id']}"  <eq name="v['type_id']" value="$gt['type_id']">selected</eq> >{$v.type_name}</option>
                                                </foreach>
									        </select>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                            <button type="submit" class="btn btn-large btn-block btn-default">提交</button>
                        </form>
                    </in>
                </div>
            </div>
        </div>
        <!--footer-->
        <include file="./Application/Admin/View/View/footer.html" />
        <!--//footer-->
    </div>
    <!-- Classie -->
    <script src="{:C('JS_URL')}classie.js"></script>
    <script>
        var menuLeft = document.getElementById('cbp-spmenu-s1'),
            showLeftPush = document.getElementById('showLeftPush'),
            body = document.body;

        showLeftPush.onclick = function () {
            classie.toggle(this, 'active');
            classie.toggle(body, 'cbp-spmenu-push-toright');
            classie.toggle(menuLeft, 'cbp-spmenu-open');
            disableOther('showLeftPush');
        };

        function disableOther(button) {
            if (button !== 'showLeftPush') {
                classie.toggle(showLeftPush, 'disabled');
            }
        }
    </script>
    <!--scrolling js-->
    <script src="{:C('JS_URL')}jquery.nicescroll.js"></script>
    <script src="{:C('JS_URL')}scripts.js"></script>
    <!--//scrolling js-->
    <!-- Bootstrap Core JavaScript -->
    <script src="{:C('JS_URL')}bootstrap.js"></script>
    
</body>


</html>

<!--点击切换类型的时候显示对应的属性-->
<!--进入极限ajax模式-->
<script>
        var temps = new Array();

        $(document).ready(noname);

        $("#type_sel").change(noname);

        function noname(e) {
           
            var index = layer.load(0, { shade: false }); //0代表加载的风格，支持0-2
            var type_id = $("#type_sel").val();
            var goods_id = {$gt['goods_id']};
 
            if (type_id == 0) {
                layer.closeAll("loading");
                $(".temp").remove();
            } else {
                // if (temps[type_id] != "") {
                //     var s = temps[type_id];
                //     $(".temp").remove();
                //     $("#flag").append(s);
                // } else {
                $.ajax({
                    type: "post",
                    url: "{:U('Goods/getAttr')}",
                    data: "type_id=" + type_id+"&goods_id="+goods_id,
                    dataType: "json",
                    success: function (msg) {
                        if (msg["status"] == 200) {
                            $(".temp").remove();
                            
                            layer.closeAll("loading");
                            var s = getString(msg['info'],msg["ga"]);
                        
                            $("#flag").append(s);
                        }
                    }
                });
                // }
            }
        }
        

        function getString(array,ga) {
            var s = "";
            for (var index = 0; index < array.length; index++) {
                var v = array[index];
                var va = "";
                s += "<tr class='temp'>";
                s += "<th scope='row'>" + v['attr_name'] + "</th>";
                if (v['attr_sel'] == "only") {
                    ga.forEach(function(element) {
                       if (element['attr_sel']=="only" && element['attr_id']==v["attr_id"]) {
                           va =element['attr_value']
                           console.log(va);
                       }  
                    }, this);
                    s += "<td><input type='text' required class='form-control1' id='focusedinput' name='attrs[" + v['attr_id'] + "]' ";
                    s += "value="+va;
                    s += "></td>";
                }
                else {
                    ga.forEach(function(element) {
                        if (element['attr_sel']=="many" && element['attr_id']==v["attr_id"]) {
                           va =element['attr_value']
                       }  
                    }, this);
                    var attr_values = v.attr_vals.split('|');
                    s += "<td>";
                    for (var i = 0; i < attr_values.length; i++) {
                        var vv = attr_values[i];
                        if(va.indexOf(vv) != -1){
                        s += "<div class='checkbox-inline'><label><input type='checkbox' name='attrs[" +v['attr_id']+ "]'  checked value='" + vv + "'>" + vv + "</label></div>";

                        }else{

                        s += "<div class='checkbox-inline'><label><input type='checkbox' name='attrs[" +v['attr_id']+ "]'  value='" + vv + "'>" + vv + "</label></div>";
                        }
                    }
                    s += "</td>";
                }
                s += "</tr>";
            }
            return s;
        }

</script>

<!--富文本引用-->
<script>
        var ue = UE.getEditor('goods_introduce', {
            toolbars: [[
                'fullscreen', 'source', '|', 'undo', 'redo', '|',
                'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',
                'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',
                'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',
                'link', 'unlink', 'anchor', '|', 'imagenone', 'imageleft', 'imageright', 'imagecenter', '|',
                'emotion'
            ]]
        });

</script>


